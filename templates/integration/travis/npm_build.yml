scripts:
    # cleanup
    clean: rimraf build

    # build site with jekyll, by default to `_site' folder
    build: jekyll build

    test: npm run build && echo "Do some validations..."

    deploy: npm run deploy-push

    # clone `master' branch of the repository using encrypted GH_TOKEN for authentification
    # copy generated HTML site to `master' branch
    # commit and push generated content to `master' branch
    # since repository was cloned in write mode with token auth - we can push there
    deploy-push: >
        cd _site &&
        git init &&
        git config user.email "$GIT_EMAIL" &&
        git config user.name "$GIT_NAME" &&
        git remote add upstream https://${GH_USERNAME}:${GH_TOKEN}@github.com/${CONFIG_OWNER}/${CONFIG_REPO}.git &&
        git fetch upstream &&
        git reset upstream/gh-pages &&
        touch .nojekyll &&
        git add -A . &&
        git commit -a -m "Travis build $TRAVIS_BUILD_NUMBER" &&
        git push --quiet upstream HEAD:gh-pages