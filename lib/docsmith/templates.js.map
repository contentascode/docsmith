{"version":3,"sources":["../../src/docsmith/templates.js"],"names":["fs","require","path","npm","templates_path","join","dirname","realpathSync","__filename","e","init","template","copy","overwrite","errorOnExist","filter","f","basename","err","console","error","load","save","progress","commands","install","log","message","process","exit","module","exports"],"mappings":";;AAAA,IAAMA,KAAKC,QAAQ,UAAR,CAAX;AACA,IAAMC,OAAOD,QAAQ,MAAR,CAAb;AACA,IAAME,MAAMF,QAAQ,KAAR,CAAZ;AACA;;AAEA,IAAIG,uBAAJ;;AAEA,IAAI;AACFA,mBAAiBF,KAAKG,IAAL,CAAUH,KAAKI,OAAL,CAAaN,GAAGO,YAAH,CAAgBC,UAAhB,CAAb,CAAV,EAAqD,aAArD,CAAjB;AACD,CAFD,CAEE,OAAOC,CAAP,EAAU;AACV;AACA;AACD;;AAED,SAASC,IAAT,CAAcC,QAAd,EAAwB;AACtB;AACA,MAAIA,YAAY,QAAZ,IAAwBA,YAAY,YAAxC,EAAsD;AACpD,QAAI;AACFX,SAAGY,IAAH,CACEV,KAAKG,IAAL,CAAUD,cAAV,EAA0B,UAAUO,QAApC,CADF,EAEE,GAFF,EAGE;AACEE,mBAAW,KADb;AAEEC,sBAAc,IAFhB;AAGEC,eAAOC,CAAP,EAAU;AACR,iBAAOd,KAAKe,QAAL,CAAcD,CAAd,KAAoB,MAA3B;AACD;AALH,OAHF,EAUE,UAASE,GAAT,EAAc;AACZ,YAAIA,GAAJ,EAAS,OAAOC,QAAQC,KAAR,CAAcF,GAAd,CAAP;AACTC,gBAAQC,KAAR,CAAc,+CAAd;AACA;AACAjB,YAAIkB,IAAJ,CAAS,EAAEC,MAAM,KAAR,EAAeC,UAAU,KAAzB,EAAT,EAA2C,UAASL,GAAT,EAAc;AACvD,cAAIA,GAAJ,EAAS,OAAOA,GAAP;AACTf,cAAIqB,QAAJ,CAAaC,OAAb,CAAqB,CAAC,GAAD,CAArB,EAA4B,UAASP,GAAT,EAAc;AACxC,gBAAIA,GAAJ,EAAS;AACPC,sBAAQO,GAAR,CAAY,yBAAyBR,IAAIS,OAAzC;AACD,aAFD,MAEO;AACLR,sBAAQO,GAAR,CAAY,EAAZ;AACAP,sBAAQO,GAAR,CAAY,wDAAwDf,QAAxD,GAAmE,YAA/E;AACAQ,sBAAQO,GAAR,CAAY,EAAZ;AACAP,sBAAQO,GAAR,CAAY,yDAAZ;AACAP,sBAAQO,GAAR,CAAY,EAAZ;AACAP,sBAAQO,GAAR,CAAY,gBAAZ;AACAP,sBAAQO,GAAR,CAAY,EAAZ;AACD;AACF,WAZD;AAaD,SAfD;AAgBD,OA9BH,EADE,CAgCC;AACJ,KAjCD,CAiCE,OAAOjB,CAAP,EAAU;AACVU,cAAQC,KAAR,CAAc,uCAAd,EAAuDT,QAAvD;AACAQ,cAAQC,KAAR,CAAcX,CAAd;AACAmB,cAAQC,IAAR,CAAa,CAAb,EAAgB,EAAhB;AACD;AACF,GAvCD,MAuCO;AACLV,YAAQC,KAAR,CAAc,kCAAd;AACAQ,YAAQC,IAAR,CAAa,CAAb,EAAgB,EAAhB;AACD;AACF;;AAEDC,OAAOC,OAAP,CAAe7B,IAAf,GAAsBE,cAAtB;AACA0B,OAAOC,OAAP,CAAerB,IAAf,GAAsBA,IAAtB","file":"templates.js","sourcesContent":["const fs = require('fs-extra');\nconst path = require('path');\nconst npm = require('npm');\n// var npmi = require('npmi');\n\nlet templates_path;\n\ntry {\n  templates_path = path.join(path.dirname(fs.realpathSync(__filename)), './templates');\n} catch (e) {\n  // Ignoring for now\n  // TODO: Finalise making templates as packages\n}\n\nfunction init(template) {\n  // Built in templates\n  if (template == 'jekyll' || template == 'metalsmith') {\n    try {\n      fs.copy(\n        path.join(templates_path, 'init-' + template),\n        '.',\n        {\n          overwrite: false,\n          errorOnExist: true,\n          filter(f) {\n            return path.basename(f) != '.git';\n          }\n        },\n        function(err) {\n          if (err) return console.error(err);\n          console.error('WARNING: Careful this probably does not work.');\n          // TODO: Finish converting to npm from npmi\n          npm.load({ save: false, progress: false }, function(err) {\n            if (err) return err;\n            npm.commands.install(['.'], function(err) {\n              if (err) {\n                console.log('Installation failed.' + err.message);\n              } else {\n                console.log('');\n                console.log('Content as Code project directory initialised with ' + template + ' template.');\n                console.log('');\n                console.log('You can find out about your current configuration with:');\n                console.log('');\n                console.log('content status');\n                console.log('');\n              }\n            });\n          });\n        }\n      ); // copies file\n    } catch (e) {\n      console.error('Error: Could not initialise template.', template);\n      console.error(e);\n      process.exit(1, '');\n    }\n  } else {\n    console.error('Error: Template not recognised .');\n    process.exit(1, '');\n  }\n}\n\nmodule.exports.path = templates_path;\nmodule.exports.init = init;\n"]}